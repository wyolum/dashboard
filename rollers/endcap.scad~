$fn=150;
mm = 1.;
inch = 24.5 * mm;

ROLLER_L = 24 * inch;
ROLLER_R = 1.5 * inch;
ROLLER_T = .125 * inch;
AXLE_D = 8 * mm;
BELT_R = 2.5 * mm;
TOTAL_H = 50 * mm;
RACE_H = 8 * mm;
BEARING_R = 11 * mm;
BEARING_H = 8 * mm;
BEARING_W = RACE_H + 7 * mm * 2;
WALL_T = 3 * mm;

module bearing(){
  cylinder(h=BEARING_H + 2, r=BEARING_R);
}

module endcap(){
  translate([0, 0, 0 * inch])
  difference(){
    union(){
      cylinder(h=TOTAL_H, r=ROLLER_R - ROLLER_T);
      cylinder(h=RACE_H, r=ROLLER_R);
    }
    union(){
      translate([0, 0, -1])cylinder(h=BEARING_W + 1, r=BEARING_R);
      translate([0, 0, -1])cylinder(h=TOTAL_H + 1, r=AXLE_D/2. + 0.5*mm);
      translate([0, 0, RACE_H/2])rotate_extrude(convexity = 10)translate([ROLLER_R + 1*mm, 0, 0])circle(r = BELT_R * mm, $fn = 100);
      translate([0, 0, BEARING_W + WALL_T])cylinder(r1=AXLE_D / 2, r2 = ROLLER_R - WALL_T, h=TOTAL_H - BEARING_W - WALL_T + 1);
    }
  }
}

module roller(x){
  difference(){
    translate([x, 0,  0])cylinder(h=ROLLER_L, r=ROLLER_R);
    translate([x, 0, -1])cylinder(h=ROLLER_L + 2, r=ROLLER_R - ROLLER_T);
  }
}
// color([0, 1, 0])roller();
difference(){
  color([1, 0, 0])endcap();
  translate([-1 - ROLLER_R, -1, -1])cube([2 * ROLLER_R + 2, ROLLER_R + 1, TOTAL_H + 2]);
}

